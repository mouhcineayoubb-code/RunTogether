<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RunTogether - Connectez les coureurs au Maroc</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container header-content">
        <a href="#" class="logo" onclick="navigateTo('home')">
          <svg
            class="logo-icon"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10" />
            <path d="M12 6v6l4 2" />
          </svg>
          <span>RunTogether</span>
        </a>
        <nav class="nav-desktop">
          <a href="#" onclick="navigateTo('home')">Accueil</a>
          <a href="#parcours" onclick="navigateTo('home')">Parcours</a>
          <a href="#courses" onclick="navigateTo('home')">Courses</a>
          <a
            href="#"
            onclick="navigateTo('messages')"
            id="navMessages"
            style="display: none"
            >Messages</a
          >
          <!-- Add link to my runs -->
          <a
            href="#"
            onclick="navigateTo('myRuns')"
            id="navMyRuns"
            style="display: none"
            >Mes Courses</a
          >
        </nav>
        <div class="header-actions">
          <!-- Add dark mode toggle button -->
          <button
            class="btn btn-ghost btn-icon"
            onclick="toggleDarkMode()"
            id="darkModeBtn"
            title="Changer le thÃ¨me"
          >
            <svg
              id="darkModeIcon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              width="20"
              height="20"
            >
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
            </svg>
          </button>
          <div id="authButtons">
            <button class="btn btn-ghost" onclick="navigateTo('login')">
              Connexion
            </button>
            <button class="btn btn-primary" onclick="navigateTo('login')">
              Rejoindre
            </button>
          </div>
          <div id="userMenu" class="user-menu" style="display: none">
            <button class="user-avatar-btn" onclick="toggleUserDropdown()">
              <img
                id="userAvatar"
                src="/placeholder.svg"
                alt="Avatar"
                class="user-avatar-img"
              />
            </button>
            <div id="userDropdown" class="user-dropdown">
              <div class="user-dropdown-header">
                <img id="dropdownAvatar" src="/placeholder.svg" alt="Avatar" />
                <div>
                  <p id="dropdownName" class="user-dropdown-name"></p>
                  <p id="dropdownEmail" class="user-dropdown-email"></p>
                </div>
              </div>
              <div class="user-dropdown-divider"></div>
              <!-- Add my runs link in dropdown -->
              <a
                href="#"
                onclick="navigateTo('myRuns')"
                class="user-dropdown-item"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                </svg>
                Mes Courses
              </a>
              <a
                href="#"
                onclick="navigateTo('messages')"
                class="user-dropdown-item"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                  />
                </svg>
                Messages
              </a>
              <a
                href="#"
                onclick="logout()"
                class="user-dropdown-item text-danger"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                  <polyline points="16,17 21,12 16,7" />
                  <line x1="21" y1="12" x2="9" y2="12" />
                </svg>
                Deconnexion
              </a>
            </div>
          </div>
        </div>
        <button class="menu-toggle" id="menuToggle">
          <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="3" y1="6" x2="21" y2="6" />
            <line x1="3" y1="12" x2="21" y2="12" />
            <line x1="3" y1="18" x2="21" y2="18" />
          </svg>
        </button>
      </div>
      <!-- Mobile Menu -->
      <nav class="nav-mobile" id="mobileNav">
        <a href="#" onclick="navigateTo('home')">Accueil</a>
        <a href="#parcours">Parcours</a>
        <a href="#courses">Courses</a>
        <a
          href="#"
          onclick="navigateTo('messages')"
          id="navMessagesMobile"
          style="display: none"
          >Messages</a
        >
        <a
          href="#"
          onclick="navigateTo('myRuns')"
          id="navMyRunsMobile"
          style="display: none"
          >Mes Courses</a
        >
        <div class="mobile-actions" id="mobileAuthButtons">
          <button class="btn btn-ghost" onclick="navigateTo('login')">
            Connexion
          </button>
          <button class="btn btn-primary" onclick="navigateTo('login')">
            Rejoindre
          </button>
        </div>
        <div class="mobile-actions" id="mobileUserInfo" style="display: none">
          <button class="btn btn-outline" onclick="logout()">
            Deconnexion
          </button>
        </div>
      </nav>
    </header>

    <!-- Main Content Container -->
    <main id="mainContent">
      <!-- Home Page -->
      <div id="homePage">
        <!-- Hero Section -->
        <section class="hero">
          <div class="container">
            <div class="hero-content">
              <span class="hero-badge">Communaute de coureurs au Maroc</span>
              <h1>
                Courez ensemble,<br /><span class="text-gradient"
                  >allez plus loin</span
                >
              </h1>
              <p>
                Decouvrez les meilleurs parcours de course au Maroc, rejoignez
                des groupes de coureurs pres de chez vous et participez a des
                evenements locaux.
              </p>
              <div class="hero-buttons">
                <button
                  class="btn btn-primary btn-lg"
                  onclick="document.getElementById('parcours').scrollIntoView({behavior: 'smooth'})"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    width="20"
                    height="20"
                  >
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                    <circle cx="12" cy="10" r="3" />
                  </svg>
                  Explorer la carte
                </button>
                <!-- Add create run button for logged in users -->
                <button
                  class="btn btn-outline btn-lg"
                  id="heroCreateRunBtn"
                  onclick="showCreateRunModal()"
                  style="display: none"
                >
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    width="20"
                    height="20"
                  >
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                  </svg>
                  Creer une course
                </button>
              </div>
              <div class="hero-stats">
                <div class="stat">
                  <span class="stat-value">2,500+</span>
                  <span class="stat-label">Coureurs actifs</span>
                </div>
                <div class="stat">
                  <span class="stat-value">45</span>
                  <span class="stat-label">Parcours</span>
                </div>
                <div class="stat">
                  <span class="stat-value">12</span>
                  <span class="stat-label">Villes</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Map Section -->
        <section class="map-section" id="parcours">
          <div class="container">
            <div class="section-header">
              <h2>Explorez les parcours</h2>
              <p>
                Decouvrez les meilleurs endroits pour courir a travers le Maroc
              </p>
              <!-- Add user location display -->
              <div
                id="userLocationDisplay"
                class="user-location-display"
                style="display: none"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  width="16"
                  height="16"
                >
                  <circle cx="12" cy="12" r="10" />
                  <circle cx="12" cy="12" r="3" />
                </svg>
                <span>Votre position: <strong id="userCoords"></strong></span>
                <button
                  class="btn btn-ghost btn-sm"
                  onclick="centerOnUserLocation()"
                >
                  Centrer
                </button>
              </div>
            </div>
            <div class="map-container">
              <div id="map"></div>
              <div class="map-sidebar">
                <div class="map-sidebar-header">
                  <h3>Lieux populaires</h3>
                  <!-- Button to locate user -->
                  <button
                    class="btn btn-ghost btn-icon"
                    onclick="getUserLocation()"
                    title="Ma position"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      width="18"
                      height="18"
                    >
                      <circle cx="12" cy="12" r="10" />
                      <circle cx="12" cy="12" r="3" />
                      <line x1="12" y1="2" x2="12" y2="4" />
                      <line x1="12" y1="20" x2="12" y2="22" />
                      <line x1="2" y1="12" x2="4" y2="12" />
                      <line x1="20" y1="12" x2="22" y2="12" />
                    </svg>
                  </button>
                </div>
                <div class="location-list" id="locationList"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Runs Section -->
        <section class="runs-section" id="courses">
          <div class="container">
            <div class="section-header">
              <h2>Courses a venir</h2>
              <p>
                Rejoignez les prochaines courses organisees par la communaute
              </p>
            </div>
            <div class="runs-grid" id="runsGrid"></div>
          </div>
        </section>

        <!-- Features Section -->
        <section class="features-section" id="communaute">
          <div class="container">
            <div class="section-header">
              <h2>Pourquoi RunTogether ?</h2>
              <p>Une plateforme concue pour les coureurs marocains</p>
            </div>
            <div class="features-grid">
              <div class="feature-card">
                <div class="feature-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                  </svg>
                </div>
                <h3>Communaute locale</h3>
                <p>
                  Connectez-vous avec des coureurs de votre ville et creez des
                  liens durables.
                </p>
              </div>
              <div class="feature-card">
                <div class="feature-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                    <circle cx="12" cy="10" r="3" />
                  </svg>
                </div>
                <h3>Parcours verifies</h3>
                <p>
                  Des parcours testes et approuves par la communaute avec toutes
                  les infos utiles.
                </p>
              </div>
              <div class="feature-card">
                <div class="feature-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <line x1="16" y1="2" x2="16" y2="6" />
                    <line x1="8" y1="2" x2="8" y2="6" />
                    <line x1="3" y1="10" x2="21" y2="10" />
                  </svg>
                </div>
                <h3>Evenements reguliers</h3>
                <p>
                  Participez a des courses hebdomadaires et des evenements
                  speciaux.
                </p>
              </div>
              <div class="feature-card">
                <div class="feature-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M12 20V10" />
                    <path d="M18 20V4" />
                    <path d="M6 20v-4" />
                  </svg>
                </div>
                <h3>Tous niveaux</h3>
                <p>
                  Du debutant a l'expert, trouvez des parcours adaptes a votre
                  niveau.
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- CTA Section -->
        <section class="cta-section">
          <div class="container">
            <div class="cta-content">
              <h2>Pret a courir ?</h2>
              <p>
                Rejoignez la communaute RunTogether et decouvrez le plaisir de
                courir ensemble.
              </p>
              <button
                class="btn btn-primary btn-lg"
                onclick="navigateTo('login')"
              >
                Creer mon compte gratuitement
              </button>
            </div>
          </div>
        </section>
      </div>

      <!-- Login Page -->
      <div id="loginPage" class="page-hidden">
        <section class="auth-section">
          <div class="auth-container">
            <div class="auth-card">
              <div class="auth-header">
                <a href="#" class="logo" onclick="navigateTo('home')">
                  <svg
                    class="logo-icon"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <path d="M12 6v6l4 2" />
                  </svg>
                  <span>RunTogether</span>
                </a>
                <h1>Rejoignez la communaute</h1>
                <p>
                  Connectez-vous pour decouvrir les courses pres de chez vous
                </p>
              </div>

              <button class="btn-google" onclick="signInWithGoogle()">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path
                    fill="#4285F4"
                    d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                  />
                  <path
                    fill="#34A853"
                    d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                  />
                  <path
                    fill="#FBBC05"
                    d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                  />
                  <path
                    fill="#EA4335"
                    d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                  />
                </svg>
                Continuer avec Google
              </button>

              <div class="auth-divider">
                <span>ou</span>
              </div>

              <form id="loginForm" onsubmit="handleEmailLogin(event)">
                <div class="form-group">
                  <label for="email">Email</label>
                  <input
                    type="email"
                    id="email"
                    placeholder="votre@email.com"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="password">Mot de passe</label>
                  <input
                    type="password"
                    id="password"
                    placeholder="********"
                    required
                  />
                </div>
                <button type="submit" class="btn btn-primary btn-full">
                  Se connecter
                </button>
              </form>

              <p class="auth-footer">
                En continuant, vous acceptez nos
                <a href="#">Conditions d'utilisation</a> et notre
                <a href="#">Politique de confidentialite</a>.
              </p>
            </div>
          </div>
        </section>
      </div>

      <!-- Run Detail Page -->
      <div id="runDetailPage" class="page-hidden">
        <section class="detail-section">
          <div class="container">
            <button class="btn btn-ghost back-btn" onclick="navigateTo('home')">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                width="20"
                height="20"
              >
                <path d="M19 12H5M12 19l-7-7 7-7" />
              </svg>
              Retour aux courses
            </button>

            <div class="detail-grid">
              <!-- Main Content -->
              <div class="detail-main">
                <div class="detail-card">
                  <div class="detail-header">
                    <div>
                      <span id="detailBadge" class="run-badge debutant"
                        >Debutant</span
                      >
                      <h1 id="detailTitle">Morning Run Corniche</h1>
                      <p id="detailLocation" class="detail-location">
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                          width="18"
                          height="18"
                        >
                          <path
                            d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"
                          />
                          <circle cx="12" cy="10" r="3" />
                        </svg>
                        Casablanca
                      </p>
                    </div>
                    <div class="detail-actions">
                      <button
                        id="joinBtn"
                        class="btn btn-primary btn-lg"
                        onclick="toggleJoinRun()"
                      >
                        Rejoindre
                      </button>
                      <!-- Add edit/delete buttons for owner -->
                      <button
                        id="editRunBtn"
                        class="btn btn-outline"
                        onclick="showEditRunModal()"
                        style="display: none"
                      >
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                          width="18"
                          height="18"
                        >
                          <path
                            d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
                          />
                          <path
                            d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
                          />
                        </svg>
                      </button>
                      <button
                        id="deleteRunBtn"
                        class="btn btn-danger"
                        onclick="confirmDeleteRun()"
                        style="display: none"
                      >
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                          width="18"
                          height="18"
                        >
                          <polyline points="3,6 5,6 21,6" />
                          <path
                            d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                          />
                        </svg>
                      </button>
                    </div>
                  </div>

                  <div class="detail-info-grid">
                    <div class="detail-info-item">
                      <div class="detail-info-icon">
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <rect
                            x="3"
                            y="4"
                            width="18"
                            height="18"
                            rx="2"
                            ry="2"
                          />
                          <line x1="16" y1="2" x2="16" y2="6" />
                          <line x1="8" y1="2" x2="8" y2="6" />
                          <line x1="3" y1="10" x2="21" y2="10" />
                        </svg>
                      </div>
                      <div>
                        <p class="detail-info-label">Date</p>
                        <p id="detailDate" class="detail-info-value">
                          Sam 25 Jan
                        </p>
                      </div>
                    </div>
                    <div class="detail-info-item">
                      <div class="detail-info-icon">
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <circle cx="12" cy="12" r="10" />
                          <polyline points="12,6 12,12 16,14" />
                        </svg>
                      </div>
                      <div>
                        <p class="detail-info-label">Heure</p>
                        <p id="detailTime" class="detail-info-value">07:00</p>
                      </div>
                    </div>
                    <div class="detail-info-item">
                      <div class="detail-info-icon">
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <path d="M18 6L6 18M6 6l12 12" />
                        </svg>
                      </div>
                      <div>
                        <p class="detail-info-label">Distance</p>
                        <p id="detailDistance" class="detail-info-value">
                          8 km
                        </p>
                      </div>
                    </div>
                    <div class="detail-info-item">
                      <div class="detail-info-icon">
                        <svg
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                          <circle cx="9" cy="7" r="4" />
                          <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                          <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                        </svg>
                      </div>
                      <div>
                        <p class="detail-info-label">Participants</p>
                        <p id="detailParticipants" class="detail-info-value">
                          24/30
                        </p>
                      </div>
                    </div>
                  </div>

                  <div class="detail-description">
                    <h3>Description</h3>
                    <p id="detailDescription">
                      Rejoignez-nous pour une course matinale le long de la
                      magnifique Corniche de Casablanca.
                    </p>
                  </div>

                  <!-- Participants List -->
                  <div class="detail-participants">
                    <h3>
                      Participants (<span id="participantCount">24</span>)
                    </h3>
                    <div class="participants-list" id="participantsList"></div>
                  </div>
                </div>

                <!-- Comments Section -->
                <div class="comments-section">
                  <h3>
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      width="20"
                      height="20"
                    >
                      <path
                        d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                      />
                    </svg>
                    Commentaires
                  </h3>

                  <div id="commentsContainer" class="comments-list"></div>

                  <form
                    id="commentForm"
                    class="comment-form"
                    onsubmit="addComment(event)"
                  >
                    <img
                      id="commentAvatar"
                      src="/placeholder.svg?height=40&width=40"
                      alt="Avatar"
                      class="comment-avatar"
                    />
                    <div class="comment-input-wrapper">
                      <textarea
                        id="commentInput"
                        placeholder="Ajouter un commentaire..."
                        rows="2"
                        required
                      ></textarea>
                      <button type="submit" class="btn btn-primary">
                        Envoyer
                      </button>
                    </div>
                  </form>
                </div>
              </div>

              <!-- Sidebar - Map -->
              <div class="detail-sidebar">
                <div class="detail-map-card">
                  <h3>Point de depart</h3>
                  <div id="detailMap" class="detail-map"></div>
                  <p class="detail-map-address" id="detailAddress">
                    Devant Morocco Mall, Corniche
                  </p>
                  <p class="detail-map-coords" id="detailCoords"></p>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Messages Page -->
      <div id="messagesPage" class="page-hidden">
        <section class="messages-section">
          <div class="container">
            <h1 class="messages-title">Messages</h1>

            <div class="messages-container">
              <!-- Conversations List -->
              <div class="conversations-list">
                <div class="conversations-header">
                  <h3>Conversations</h3>
                  <button
                    class="btn btn-ghost btn-icon"
                    onclick="showNewConversation()"
                  >
                    <svg
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      width="20"
                      height="20"
                    >
                      <line x1="12" y1="5" x2="12" y2="19" />
                      <line x1="5" y1="12" x2="19" y2="12" />
                    </svg>
                  </button>
                </div>
                <div id="conversationsList" class="conversations-items"></div>
              </div>

              <!-- Chat Area -->
              <div class="chat-area" id="chatArea">
                <div class="chat-empty" id="chatEmpty">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    width="48"
                    height="48"
                  >
                    <path
                      d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                    />
                  </svg>
                  <p>Selectionnez une conversation pour commencer</p>
                </div>

                <div
                  id="chatContent"
                  class="chat-content"
                  style="display: none"
                >
                  <div class="chat-header">
                    <button
                      class="btn btn-ghost btn-icon chat-back-mobile"
                      onclick="closeChatMobile()"
                    >
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        width="20"
                        height="20"
                      >
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                      </svg>
                    </button>
                    <img
                      id="chatAvatar"
                      src="/placeholder.svg"
                      alt="Avatar"
                      class="chat-header-avatar"
                    />
                    <div class="chat-header-info">
                      <h4 id="chatName"></h4>
                      <span id="chatStatus" class="chat-status">En ligne</span>
                    </div>
                  </div>
                  <div class="chat-messages" id="chatMessages"></div>
                  <form class="chat-input-form" onsubmit="sendMessage(event)">
                    <input
                      type="text"
                      id="messageInput"
                      placeholder="Ecrivez un message..."
                      required
                    />
                    <button type="submit" class="btn btn-primary">
                      <svg
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        width="20"
                        height="20"
                      >
                        <line x1="22" y1="2" x2="11" y2="13" />
                        <polygon points="22,2 15,22 11,13 2,9" />
                      </svg>
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- My Runs Page -->
      <div id="myRunsPage" class="page-hidden">
        <section class="my-runs-section">
          <div class="container">
            <div class="my-runs-header">
              <h1>Mes Courses</h1>
              <button class="btn btn-primary" onclick="showCreateRunModal()">
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  width="20"
                  height="20"
                >
                  <line x1="12" y1="5" x2="12" y2="19" />
                  <line x1="5" y1="12" x2="19" y2="12" />
                </svg>
                Creer une course
              </button>
            </div>

            <div class="my-runs-grid" id="myRunsGrid">
              <div class="no-runs-message">
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  width="48"
                  height="48"
                >
                  <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
                </svg>
                <p>Vous n'avez pas encore cree de course.</p>
                <button class="btn btn-primary" onclick="showCreateRunModal()">
                  Creer ma premiere course
                </button>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Create/Edit Run Modal -->
    <div id="runModal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeRunModal()"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Creer une course</h2>
          <button class="btn btn-ghost btn-icon" onclick="closeRunModal()">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              width="24"
              height="24"
            >
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>
        <form id="runForm" onsubmit="handleRunSubmit(event)">
          <div class="form-row">
            <div class="form-group">
              <label for="runTitle">Titre de la course</label>
              <input
                type="text"
                id="runTitle"
                placeholder="Ex: Morning Run Corniche"
                required
              />
            </div>
            <div class="form-group">
              <label for="runCity">Ville</label>
              <select id="runCity" required>
                <option value="">Selectionnez une ville</option>
                <option value="Casablanca">Casablanca</option>
                <option value="Rabat">Rabat</option>
                <option value="Marrakech">Marrakech</option>
                <option value="Agadir">Agadir</option>
                <option value="Tanger">Tanger</option>
                <option value="Fes">Fes</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="runDate">Date</label>
              <input type="date" id="runDate" required />
            </div>
            <div class="form-group">
              <label for="runTime">Heure</label>
              <input type="time" id="runTime" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="runDistance">Distance (km)</label>
              <input
                type="number"
                id="runDistance"
                placeholder="8"
                min="1"
                max="100"
                required
              />
            </div>
            <div class="form-group">
              <label for="runDifficulty">Niveau</label>
              <select id="runDifficulty" required>
                <option value="debutant">Debutant</option>
                <option value="intermediaire">Intermediaire</option>
                <option value="expert">Expert</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="runMaxParticipants">Places disponibles</label>
            <input
              type="number"
              id="runMaxParticipants"
              placeholder="30"
              min="2"
              max="500"
              required
            />
          </div>
          <div class="form-group">
            <label for="runDescription">Description</label>
            <textarea
              id="runDescription"
              rows="4"
              placeholder="Decrivez votre course..."
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="runAddress">Point de rendez-vous</label>
            <input
              type="text"
              id="runAddress"
              placeholder="Ex: Devant Morocco Mall"
              required
            />
          </div>
          <div class="form-group">
            <label>Position sur la carte (cliquez pour definir)</label>
            <div id="modalMap" class="modal-map"></div>
            <p class="map-coords-display">
              Coordonnees: <span id="selectedCoords">Non defini</span>
            </p>
            <input type="hidden" id="runLat" />
            <input type="hidden" id="runLng" />
          </div>
          <div class="modal-actions">
            <button
              type="button"
              class="btn btn-outline"
              onclick="closeRunModal()"
            >
              Annuler
            </button>
            <button type="submit" class="btn btn-primary" id="submitRunBtn">
              Creer la course
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div id="deleteModal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeDeleteModal()"></div>
      <div class="modal-content modal-small">
        <div class="modal-header">
          <h2>Supprimer la course</h2>
          <button class="btn btn-ghost btn-icon" onclick="closeDeleteModal()">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              width="24"
              height="24"
            >
              <line x1="18" y1="6" x2="6" y2="18" />
              <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
          </button>
        </div>
        <p class="delete-warning">
          Etes-vous sur de vouloir supprimer cette course ? Cette action est
          irreversible.
        </p>
        <div class="modal-actions">
          <button
            type="button"
            class="btn btn-outline"
            onclick="closeDeleteModal()"
          >
            Annuler
          </button>
          <button type="button" class="btn btn-danger" onclick="deleteRun()">
            Supprimer
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-brand">
            <a href="#" class="logo" onclick="navigateTo('home')">
              <svg
                class="logo-icon"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
                <path d="M12 6v6l4 2" />
              </svg>
              <span>RunTogether</span>
            </a>
            <p>Connecter les coureurs au Maroc depuis 2024.</p>
          </div>
          <div class="footer-links">
            <div class="footer-column">
              <h4>Plateforme</h4>
              <a href="#">Parcours</a>
              <a href="#">Courses</a>
              <a href="#">Communaute</a>
            </div>
            <div class="footer-column">
              <h4>Support</h4>
              <a href="#">FAQ</a>
              <a href="#">Contact</a>
              <a href="#">Aide</a>
            </div>
            <div class="footer-column">
              <h4>Legal</h4>
              <a href="#">Confidentialite</a>
              <a href="#">Conditions</a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>2024 RunTogether. Tous droits reserves.</p>
        </div>
      </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="script.js"></script>
  </body>
</html>
